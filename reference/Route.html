<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Create a route for dispatching on URL — Route • routr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Create a route for dispatching on URL — Route"><meta property="og:description" content="The Route class is used to encapsulate a single URL dispatch, that is,
chose a single handler from a range based on a URL path. A handler will be
called with a request, response, and keys argument as well as any additional
arguments passed on to dispatch()."><meta property="og:image" content="https://routr.data-imaginist.com/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">routr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Release notes</li>
    <li>
      <a href="https://www.data-imaginist.com/2017/introducing-routr/" class="external-link">Version 0.2.0</a>
    </li>
    <li class="divider">
    <li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://fiery.data-imaginist.com" class="external-link">fiery</a>
</li>
<li>
  <a href="https://reqres.data-imaginist.com" class="external-link">reqres</a>
</li>
<li>
  <a href="https://github.com/thomasp85/reqres" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a route for dispatching on URL</h1>
    <small class="dont-index">Source: <a href="https://github.com/thomasp85/routr/blob/HEAD/R/route.R" class="external-link"><code>R/route.R</code></a></small>
    <div class="hidden name"><code>Route.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>Route</code> class is used to encapsulate a single URL dispatch, that is,
chose a single handler from a range based on a URL path. A handler will be
called with a request, response, and keys argument as well as any additional
arguments passed on to <code>dispatch()</code>.</p>
    </div>


    <div id="details">
    <h2>Details</h2>
    <p>The path will strip the query string prior to assignment of the handler, can
contain wildcards, and can be parameterised using the <code>:</code> prefix. If there
are multiple matches of the request path the most specific will be chosen.
Specificity is based on number of elements (most), number of parameters
(least), and number of wildcards (least), in that order. Parameter
values will be available in the keys argument passed to the handler, e.g. a
path of <code>/user/:user_id</code> will provide <code>list(user_id = 123)</code> for a dispatch on
<code>/user/123</code> in the <code>keys</code> argument.</p>
<p>Handlers are only called for their side-effects and are expected to return
either <code>TRUE</code> or <code>FALSE</code> indicating whether additional routes in a
<code><a href="RouteStack.html">RouteStack</a></code> should be called, e.g. if a handler is returning <code>FALSE</code> all
further processing of the request will be terminated and the response will be
passed along in its current state. Thus, the intend of the handlers is to
modify the request and response objects, in place. All calls to handlers will
be wrapped in <code><a href="https://rdrr.io/r/base/try.html" class="external-link">try()</a></code> and if an exception is raised the response code will be
set to <code>500</code> with the body of the response being the error message. Further
processing of the request will be terminated. If a different error handling
scheme is wanted it must be implemented within the handler (the standard
approach is chosen to avoid handler errors resulting in a server crash).</p>
<p>A handler is referencing a specific HTTP method (<code>get</code>, <code>post</code>, etc.) but can
also reference <code>all</code> to indicate that it should match all types of requests.
Handlers referencing <code>all</code> have lower precedence than those referencing
specific methods, so will only be called if a match is not found within the
handlers of the specific method.</p>
    </div>
    <div id="initialization">
    <h2>Initialization</h2>
    

<p>A new 'Route'-object is initialized using the <code>new()</code> method on the
generator:</p>
<p><strong>Usage</strong></p><table class="table table"><tr><td><code>route &lt;- Route$new(...)</code></td></tr></table><p><strong>Arguments</strong></p><table class="table table"><tr><td><code>...</code></td><td></td><td>Handlers to add up front. Must be in the form of named
lists where the names corresponds to paths and the elements are the handlers.
The name of the argument itself defines the method to listen on (see examples)</td></tr></table></div>
    <div id="methods">
    <h2>Methods</h2>
    

<p>The following methods are accessible in a <code>Route</code> object:</p>
<dl><dt><code>add_handler(method, path, handler)</code></dt>
<dd><p>Add a handler to the specified
method and path. The special method <code>'all'</code> will allow the handler to match
all http request methods. The path is a URL path consisting of strings,
parameters (strings prefixed with <code>:</code>), and wildcards (<code>*</code>), separated by
<code>/</code>. A wildcard will match anything and is thus not restricted to a single
path element (i.e. it will span multiple <code>/</code> if possible). The handler must
be a function containing the arguments <code>request</code>, <code>response</code>, <code>keys</code>, and
<code>...</code>, and must return either <code>TRUE</code> or <code>FALSE</code>. The <code>request</code> argument will
be a <a href="https://reqres.data-imaginist.com/reference/Request.html" class="external-link">reqres::Request</a> object and the <code>response</code> argument will be a
<a href="https://reqres.data-imaginist.com/reference/Response.html" class="external-link">reqres::Response</a> object matching the current exchange. The <code>keys</code> argument
will be a named list with the value of all matched parameters from the path.
Any additional argument passed on to the <code>dispatch</code> method will be avaiable
as well. This method will override an existing handler with the same method
and path.</p></dd>

<dt><code>remove_handler(method, path)</code></dt>
<dd><p>Removes the handler assigned to the
specified method and path. If no handler have been assigned it will throw a
warning.</p></dd>

<dt><code>get_handler(method, path)</code></dt>
<dd><p>Returns a handler already assigned
to the specified method and path. If no handler have been assigned it will
throw a warning.</p></dd>

<dt><code>remap_handlers(.f)</code></dt>
<dd><p>Allows you to loop through all added handlers
and reassings them at will. A function with the parameters <code>method</code>, <code>path</code>,
and <code>handler</code> must be provided which is responsible for reassigning the
handler given in the arguments. If the function does not reassign the
handler, then the handler is removed.</p></dd>

<dt><code>dispatch(request, ...)</code></dt>
<dd><p>Based on a <a href="https://reqres.data-imaginist.com/reference/Request.html" class="external-link">reqres::Request</a> object the
route will find the correct handler and call it with the correct arguments.
Anything passed in with <code>...</code> will be passed along to the handler.</p></dd>


</dl></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="RouteStack.html">RouteStack</a> for binding multiple routes sequentially</p></div>
    </div>
    <div id="methods">
    <h2>Methods</h2>
    
<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-Route-new"><code>Route$new()</code></a></p></li>
<li><p><a href="#method-Route-print"><code>Route$print()</code></a></p></li>
<li><p><a href="#method-Route-add_handler"><code>Route$add_handler()</code></a></p></li>
<li><p><a href="#method-Route-remove_handler"><code>Route$remove_handler()</code></a></p></li>
<li><p><a href="#method-Route-get_handler"><code>Route$get_handler()</code></a></p></li>
<li><p><a href="#method-Route-remap_handlers"><code>Route$remap_handlers()</code></a></p></li>
<li><p><a href="#method-Route-dispatch"><code>Route$dispatch()</code></a></p></li>
<li><p><a href="#method-Route-clone"><code>Route$clone()</code></a></p></li>
</ul></div><p></p><hr><a id="method-Route-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>

<div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/Route.html">Route</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Route-print"></a><div class="section">
<h3 id="method-print-">Method <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code><a class="anchor" aria-label="anchor" href="#method-print-"></a></h3>

<div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Route</span><span class="op">$</span><span class="fu">print</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Route-add_handler"></a><div class="section">
<h3 id="method-add-handler-">Method <code>add_handler()</code><a class="anchor" aria-label="anchor" href="#method-add-handler-"></a></h3>

<div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Route</span><span class="op">$</span><span class="fu">add_handler</span><span class="op">(</span><span class="va">method</span>, <span class="va">path</span>, <span class="va">handler</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Route-remove_handler"></a><div class="section">
<h3 id="method-remove-handler-">Method <code>remove_handler()</code><a class="anchor" aria-label="anchor" href="#method-remove-handler-"></a></h3>

<div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Route</span><span class="op">$</span><span class="fu">remove_handler</span><span class="op">(</span><span class="va">method</span>, <span class="va">path</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Route-get_handler"></a><div class="section">
<h3 id="method-get-handler-">Method <code>get_handler()</code><a class="anchor" aria-label="anchor" href="#method-get-handler-"></a></h3>

<div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Route</span><span class="op">$</span><span class="fu">get_handler</span><span class="op">(</span><span class="va">method</span>, <span class="va">path</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Route-remap_handlers"></a><div class="section">
<h3 id="method-remap-handlers-">Method <code>remap_handlers()</code><a class="anchor" aria-label="anchor" href="#method-remap-handlers-"></a></h3>

<div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Route</span><span class="op">$</span><span class="fu">remap_handlers</span><span class="op">(</span><span class="va">.f</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Route-dispatch"></a><div class="section">
<h3 id="method-dispatch-">Method <code>dispatch()</code><a class="anchor" aria-label="anchor" href="#method-dispatch-"></a></h3>

<div class="section">
<h4 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Route</span><span class="op">$</span><span class="fu">dispatch</span><span class="op">(</span><span class="va">request</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Route-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Route</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Initialise an empty route</span></span></span>
<span class="r-in"><span><span class="va">route</span> <span class="op">&lt;-</span> <span class="va">Route</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Initialise a route with handlers assigned</span></span></span>
<span class="r-in"><span><span class="va">route</span> <span class="op">&lt;-</span> <span class="va">Route</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span></span>
<span class="r-in"><span>  all <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">'/*'</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">request</span>, <span class="va">response</span>, <span class="va">keys</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">'Request recieved'</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Remove it again</span></span></span>
<span class="r-in"><span><span class="va">route</span><span class="op">$</span><span class="fu">remove_handler</span><span class="op">(</span><span class="st">'all'</span>, <span class="st">'/*'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://data-imaginist.com" class="external-link">Thomas Lin Pedersen</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

