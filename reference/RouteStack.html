<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Combine multiple routes for sequential routing — RouteStack • routr</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Combine multiple routes for sequential routing — RouteStack"><meta name="description" content="Combine multiple routes for sequential routing
Combine multiple routes for sequential routing"><meta property="og:description" content="Combine multiple routes for sequential routing
Combine multiple routes for sequential routing"><meta property="og:image" content="https://routr.data-imaginist.com/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">routr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Release notes</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.data-imaginist.com/2017/introducing-routr/">Version 0.2.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Change log</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://fiery.data-imaginist.com">fiery</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://reqres.data-imaginist.com">reqres</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/thomasp85/routr"><span class="fa fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Combine multiple routes for sequential routing</h1>
      <small class="dont-index">Source: <a href="https://github.com/thomasp85/routr/blob/main/R/routestack.R" class="external-link"><code>R/routestack.R</code></a></small>
      <div class="d-none name"><code>RouteStack.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Combine multiple routes for sequential routing</p>
<p>Combine multiple routes for sequential routing</p>
    </div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>RouteStack</code> class encapsulate multiple <a href="Route-class.html">Route</a>s and lets a request be
passed through each sequentially. If a route is returning <code>FALSE</code> upon
dispatch further dispatching is cancelled.</p>
    </div>
    <div class="section level2">
    <h2 id="initialization">Initialization<a class="anchor" aria-label="anchor" href="#initialization"></a></h2>


<p>A new 'RouteStack'-object is initialized using the <code>new()</code> method on the
generator:</p>
<p><strong>Usage</strong></p><table class="table table"><tr><td><code>router &lt;- RouteStack$new(..., path_extractor = function(msg, bin) '/')</code></td></tr></table></div>
    <div class="section level2">
    <h2 id="fiery-plugin">Fiery plugin<a class="anchor" aria-label="anchor" href="#fiery-plugin"></a></h2>


<p>A <code>RouteStack</code> object is a valid <code>fiery</code> plugin and can thus be passed in to
the <code><a href="https://rdrr.io/r/base/attach.html" class="external-link">attach()</a></code> method of a <code>Fire</code> object. When used as a fiery plugin it is
important to be concious for what event it is attached to. By default it will
be attached to the <code>request</code> event and thus be used to handle HTTP request
messaging. An alternative is to attach it to the <code>header</code> event that is fired
when all headers have been received but before the body is. This allows you
to short-circuit request handling and e.g. reject requests above a certain
size. When the router is attached to the <code>header</code> event any handler returning
<code>FALSE</code> will signal that further handling of the request should be stopped
and the response in its current form should be returned without fetching the
request body.</p>
<p>One last possibility is to attach it to the <code>message</code> event and thus use it
to handle WebSocket messages. This use case is a bit different from that of
<code>request</code> and <code>header</code>. As <code>routr</code> uses <code>Request</code> objects as a vessel between
routes and WebSocket messages are not HTTP requests, some modification is
needed. The way <code>routr</code> achieves this is be modifying the HTTP request that
established the WebSocket connection and send this through the routes. Using
the <code>path_extractor</code> function provided in the <code>RouteStack</code> constructor it
will extract a path to dispatch on and assign it to the request. Furthermore
it assigns the message to the body of the request and sets the <code>Content-Type</code>
header based on whether the message is binary <code>application/octet-stream</code> or
not <code>text/plain</code>. As WebSocket communication is asynchronous the response is
ignored when attached to the <code>message</code> event. If communication should be send
back, use <code>server$send()</code> inside the handler(s).</p>
<p>How a <code>RouteStack</code> is attached is defined by the <code>attach_to</code> field which must
be either <code>'request'</code>, <code>'header'</code>, or <code>'message'</code>.</p>
<p>When attaching the <code>RouteStack</code> it is possible to modify how errors are
handled, using the <code>on_error</code> argument, which will change the error handler
set on the <code>RouteStack</code>. By default the error handler will be changed to
using the <code>fiery</code> logging system if the <code>Fire</code> object supports it.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="Route-class.html">Route</a> for defining single routes</p></div>
    </div>
    <div class="section level2">
    <h2 id="active-bindings">Active bindings<a class="anchor" aria-label="anchor" href="#active-bindings"></a></h2>
    <p></p><div class="r6-active-bindings"><dl><dt><code>attach_to</code></dt>
<dd><p>The event this routr should respond to</p></dd>


<dt><code>name</code></dt>
<dd><p>An autogenerated name for the route stack</p></dd>


<dt><code>routes</code></dt>
<dd><p>Gices the name of all routes in the stack</p></dd>


<dt><code>empty</code></dt>
<dd><p>Is the route stack empty</p></dd>


</dl><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-RouteStack-new"><code>RouteStack$new()</code></a></p></li>
<li><p><a href="#method-RouteStack-print"><code>RouteStack$print()</code></a></p></li>
<li><p><a href="#method-RouteStack-add_route"><code>RouteStack$add_route()</code></a></p></li>
<li><p><a href="#method-RouteStack-add_redirect"><code>RouteStack$add_redirect()</code></a></p></li>
<li><p><a href="#method-RouteStack-get_route"><code>RouteStack$get_route()</code></a></p></li>
<li><p><a href="#method-RouteStack-has_route"><code>RouteStack$has_route()</code></a></p></li>
<li><p><a href="#method-RouteStack-remove_route"><code>RouteStack$remove_route()</code></a></p></li>
<li><p><a href="#method-RouteStack-dispatch"><code>RouteStack$dispatch()</code></a></p></li>
<li><p><a href="#method-RouteStack-dispatch_to_first_match"><code>RouteStack$dispatch_to_first_match()</code></a></p></li>
<li><p><a href="#method-RouteStack-on_attach"><code>RouteStack$on_attach()</code></a></p></li>
<li><p><a href="#method-RouteStack-merge_stack"><code>RouteStack$merge_stack()</code></a></p></li>
<li><p><a href="#method-RouteStack-clone"><code>RouteStack$clone()</code></a></p></li>
</ul></div><p></p><hr><a id="method-RouteStack-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Create a new RouteStack</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/RouteStack.html">RouteStack</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">...</span>, path_extractor <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">msg</span>, <span class="va">bin</span><span class="op">)</span> <span class="st">"/"</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>...</code></dt>
<dd><p>Routes to add up front. Must be in the form of named arguments
containing <code>Route</code> objects.</p></dd>


<dt><code>path_extractor</code></dt>
<dd><p>A function that returns a path to dispatch on from
a WebSocket message. Will only be used if <code>attach_to == 'message'</code>.
Defaults to a function returning <code>'/'</code></p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-RouteStack-print"></a><div class="section">
<h3 id="method-print-">Method <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code><a class="anchor" aria-label="anchor" href="#method-print-"></a></h3>
<p>Pretty printing of the object</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">RouteStack</span><span class="op">$</span><span class="fu">print</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>...</code></dt>
<dd><p>Ignored</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-RouteStack-add_route"></a><div class="section">
<h3 id="method-add-route-">Method <code>add_route()</code><a class="anchor" aria-label="anchor" href="#method-add-route-"></a></h3>
<p>Adds a new route to the stack. <code>route</code> must be a <code>Route</code>
object, <code>name</code> must be a string. If <code>after</code> is given the route will be
inserted after the given index, if not (or <code>NULL</code>) it will be inserted in
the end of the stack.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">RouteStack</span><span class="op">$</span><span class="fu">add_route</span><span class="op">(</span><span class="va">route</span>, <span class="va">name</span>, after <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>route</code></dt>
<dd><p>A <code>Route</code> object</p></dd>


<dt><code>name</code></dt>
<dd><p>The name of the route</p></dd>


<dt><code>after</code></dt>
<dd><p>The location in the stack to put the route</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-RouteStack-add_redirect"></a><div class="section">
<h3 id="method-add-redirect-">Method <code>add_redirect()</code><a class="anchor" aria-label="anchor" href="#method-add-redirect-"></a></h3>
<p>Adds a permanent (308) or temporary (307) redirect from a
path to another. The paths can contain path arguments and wildcards, but
all those present in <code>to</code> must also be present in <code>from</code> (the reverse is
not required)</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">RouteStack</span><span class="op">$</span><span class="fu">add_redirect</span><span class="op">(</span><span class="va">method</span>, <span class="va">from</span>, <span class="va">to</span>, permanent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>method</code></dt>
<dd><p>The http method to match the handler to</p></dd>


<dt><code>from</code></dt>
<dd><p>The path the redirect should respond to</p></dd>


<dt><code>to</code></dt>
<dd><p>The path the redirect should signal to the client as the new
path</p></dd>


<dt><code>permanent</code></dt>
<dd><p>Logical. If <code>TRUE</code> then a 308 Permanent Redirect is send
back, instructing the client to update the URL in the browser to show the
new path as well as avoid sending requests to the old URL again. If
<code>FALSE</code> then a 307 Temporary Redirect is send back, instructing the
client to proceed as if the response comes from the old path</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-RouteStack-get_route"></a><div class="section">
<h3 id="method-get-route-">Method <code>get_route()</code><a class="anchor" aria-label="anchor" href="#method-get-route-"></a></h3>
<p>Get the route with a given name</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">RouteStack</span><span class="op">$</span><span class="fu">get_route</span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>name</code></dt>
<dd><p>The name of the route to retrieve</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-RouteStack-has_route"></a><div class="section">
<h3 id="method-has-route-">Method <code>has_route()</code><a class="anchor" aria-label="anchor" href="#method-has-route-"></a></h3>
<p>Test if the routestack contains a route with the given name.</p><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">RouteStack</span><span class="op">$</span><span class="fu">has_route</span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-5">Arguments<a class="anchor" aria-label="anchor" href="#arguments-5"></a></h4>
<p></p><div class="arguments"><dl><dt><code>name</code></dt>
<dd><p>The name of the route to look for</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-RouteStack-remove_route"></a><div class="section">
<h3 id="method-remove-route-">Method <code>remove_route()</code><a class="anchor" aria-label="anchor" href="#method-remove-route-"></a></h3>
<p>Removes the route with the given name from the stack.</p><div class="section">
<h4 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">RouteStack</span><span class="op">$</span><span class="fu">remove_route</span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-6">Arguments<a class="anchor" aria-label="anchor" href="#arguments-6"></a></h4>
<p></p><div class="arguments"><dl><dt><code>name</code></dt>
<dd><p>The name of the route to remove</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-RouteStack-dispatch"></a><div class="section">
<h3 id="method-dispatch-">Method <code>dispatch()</code><a class="anchor" aria-label="anchor" href="#method-dispatch-"></a></h3>
<p>Passes a <a href="https://reqres.data-imaginist.com/reference/Request.html" class="external-link">reqres::Request</a> through the stack of routes in
sequence until one of the routes return <code>FALSE</code> or every route have been
passed through. <code>...</code> will be passed on to the dispatch of each <code>Route</code>
on the stack.</p><div class="section">
<h4 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">RouteStack</span><span class="op">$</span><span class="fu">dispatch</span><span class="op">(</span><span class="va">request</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-7">Arguments<a class="anchor" aria-label="anchor" href="#arguments-7"></a></h4>
<p></p><div class="arguments"><dl><dt><code>request</code></dt>
<dd><p>The request to route</p></dd>


<dt><code>...</code></dt>
<dd><p>Additional arguments to pass on to the handlers</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-RouteStack-dispatch_to_first_match"></a><div class="section">
<h3 id="method-dispatch-to-first-match-">Method <code>dispatch_to_first_match()</code><a class="anchor" aria-label="anchor" href="#method-dispatch-to-first-match-"></a></h3>
<p>asses a <a href="https://reqres.data-imaginist.com/reference/Request.html" class="external-link">reqres::Request</a> through the stack of routes in
sequence until a handler is found. <code>...</code> will be passed on to the
dispatch of each <code>Route</code> on the stack. This dispatch does not require the
handler to return a boolean, and will return the value of the handler
call or <code>NULL</code> if no handler is matched</p><div class="section">
<h4 id="usage-8">Usage<a class="anchor" aria-label="anchor" href="#usage-8"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">RouteStack</span><span class="op">$</span><span class="fu">dispatch_to_first_match</span><span class="op">(</span><span class="va">request</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-8">Arguments<a class="anchor" aria-label="anchor" href="#arguments-8"></a></h4>
<p></p><div class="arguments"><dl><dt><code>request</code></dt>
<dd><p>The request to route</p></dd>


<dt><code>...</code></dt>
<dd><p>Additional arguments to pass on to the handlers</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-RouteStack-on_attach"></a><div class="section">
<h3 id="method-on-attach-">Method <code>on_attach()</code><a class="anchor" aria-label="anchor" href="#method-on-attach-"></a></h3>
<p>Method for use by <code>fiery</code> when attached as a plugin. Should
not be called directly.</p><div class="section">
<h4 id="usage-9">Usage<a class="anchor" aria-label="anchor" href="#usage-9"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">RouteStack</span><span class="op">$</span><span class="fu">on_attach</span><span class="op">(</span><span class="va">app</span>, on_error <span class="op">=</span> <span class="fu">deprecated</span><span class="op">(</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-9">Arguments<a class="anchor" aria-label="anchor" href="#arguments-9"></a></h4>
<p></p><div class="arguments"><dl><dt><code>app</code></dt>
<dd><p>The Fire object to attach the router to</p></dd>


<dt><code>on_error</code></dt>
<dd><p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> A function for error handling</p></dd>


<dt><code>...</code></dt>
<dd><p>Ignored</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-RouteStack-merge_stack"></a><div class="section">
<h3 id="method-merge-stack-">Method <code>merge_stack()</code><a class="anchor" aria-label="anchor" href="#method-merge-stack-"></a></h3>
<p>Merge two route stacks together adding all routes from the
other route to this. The other route stack will be empty after this.</p><div class="section">
<h4 id="usage-10">Usage<a class="anchor" aria-label="anchor" href="#usage-10"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">RouteStack</span><span class="op">$</span><span class="fu">merge_stack</span><span class="op">(</span><span class="va">stack</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-10">Arguments<a class="anchor" aria-label="anchor" href="#arguments-10"></a></h4>
<p></p><div class="arguments"><dl><dt><code>stack</code></dt>
<dd><p>Another RouteStack object to merge into this one</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-RouteStack-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-11">Usage<a class="anchor" aria-label="anchor" href="#usage-11"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">RouteStack</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-11">Arguments<a class="anchor" aria-label="anchor" href="#arguments-11"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Create a new stack</span></span></span>
<span class="r-in"><span><span class="va">routes</span> <span class="op">&lt;-</span> <span class="va">RouteStack</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Populate it wih routes</span></span></span>
<span class="r-in"><span><span class="va">first</span> <span class="op">&lt;-</span> <span class="va"><a href="Route-class.html">Route</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">first</span><span class="op">$</span><span class="fu">add_handler</span><span class="op">(</span><span class="st">'all'</span>, <span class="st">'*'</span>, <span class="kw">function</span><span class="op">(</span><span class="va">request</span>, <span class="va">response</span>, <span class="va">keys</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">'This will always get called first'</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">second</span> <span class="op">&lt;-</span> <span class="va"><a href="Route-class.html">Route</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">second</span><span class="op">$</span><span class="fu">add_handler</span><span class="op">(</span><span class="st">'get'</span>, <span class="st">'/demo/'</span>, <span class="kw">function</span><span class="op">(</span><span class="va">request</span>, <span class="va">response</span>, <span class="va">keys</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">'This will get called next if the request asks for /demo/'</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">routes</span><span class="op">$</span><span class="fu">add_route</span><span class="op">(</span><span class="va">first</span>, <span class="st">'first'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">routes</span><span class="op">$</span><span class="fu">add_route</span><span class="op">(</span><span class="va">second</span>, <span class="st">'second'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Send a request through</span></span></span>
<span class="r-in"><span><span class="va">rook</span> <span class="op">&lt;-</span> <span class="fu">fiery</span><span class="fu">::</span><span class="fu"><a href="https://fiery.data-imaginist.com/reference/fake_request.html" class="external-link">fake_request</a></span><span class="op">(</span><span class="st">'http://example.com/demo/'</span>, method <span class="op">=</span> <span class="st">'get'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">req</span> <span class="op">&lt;-</span> <span class="fu">reqres</span><span class="fu">::</span><span class="va"><a href="https://reqres.data-imaginist.com/reference/Request.html" class="external-link">Request</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">rook</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">routes</span><span class="op">$</span><span class="fu">dispatch</span><span class="op">(</span><span class="va">req</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> This will always get called first</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> This will get called next if the request asks for /demo/</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://data-imaginist.com" class="external-link">Thomas Lin Pedersen</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

